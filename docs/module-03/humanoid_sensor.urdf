<?xml version="1.0"?>
<robot name="sensor_equipped_humanoid" xmlns:xacro="http://www.ros.org/wiki/xacro">
  <!-- Base and trunk -->
  <link name="base_link">
    <inertial>
      <mass value="1.0"/>
      <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.01" iyz="0.0" izz="0.02"/>
    </inertial>
  </link>

  <!-- Head with depth camera -->
  <joint name="head_joint" type="revolute">
    <parent link="base_link"/>
    <child link="head_link"/>
    <origin xyz="0 0 0.5" rpy="0 0 0"/>
    <axis xyz="0 0 1"/>
    <limit lower="-1.57" upper="1.57" effort="10" velocity="2"/>
  </joint>

  <link name="head_link">
    <inertial>
      <mass value="1.0"/>
      <inertia ixx="0.01" ixy="0.0" ixz="0.0" iyy="0.01" iyz="0.0" izz="0.01"/>
    </inertial>
  </link>

  <!-- Depth camera -->
  <joint name="camera_joint" type="fixed">
    <parent link="head_link"/>
    <child link="camera_link"/>
    <origin xyz="0.05 0 0.05" rpy="0 0 0"/>
  </joint>

  <link name="camera_link"/>

  <gazebo reference="camera_link">
    <sensor name="depth_camera" type="depth">
      <update_rate>30</update_rate>
      <camera name="head_camera">
        <horizontal_fov>1.047</horizontal_fov>
        <image>
          <width>848</width>
          <height>480</height>
          <format>RGB8</format>
        </image>
        <clip>
          <near>0.1</near>
          <far>10</far>
        </clip>
      </camera>
      <always_on>true</always_on>
      <visualize>true</visualize>
    </sensor>
  </gazebo>

  <!-- LiDAR -->
  <joint name="lidar_joint" type="fixed">
    <parent link="head_link"/>
    <child link="lidar_link"/>
    <origin xyz="0.0 0 0.1" rpy="0 0 0"/>
  </joint>

  <link name="lidar_link"/>

  <gazebo reference="lidar_link">
    <sensor name="gpu_lidar" type="gpu_lidar">
      <update_rate>10</update_rate>
      <ray>
        <scan>
          <horizontal>
            <samples>1024</samples>
            <resolution>1</resolution>
            <min_angle>-3.14159</min_angle>
            <max_angle>3.14159</max_angle>
          </horizontal>
          <vertical>
            <samples>16</samples>
            <resolution>1</resolution>
            <min_angle>-0.349066</min_angle>
            <max_angle>0.349066</max_angle>
          </vertical>
        </scan>
        <range>
          <min>0.1</min>
          <max>30.0</max>
          <resolution>0.01</resolution>
        </range>
      </ray>
      <always_on>true</always_on>
      <visualize>false</visualize>
    </sensor>
  </gazebo>

  <!-- IMU -->
  <joint name="imu_joint" type="fixed">
    <parent link="base_link"/>
    <child link="imu_link"/>
    <origin xyz="0 0 0.1" rpy="0 0 0"/>
  </joint>

  <link name="imu_link"/>

  <gazebo reference="imu_link">
    <sensor name="imu_sensor" type="imu">
      <update_rate>100</update_rate>
      <topic>imu/data</topic>
      <always_on>true</always_on>
      <visualize>false</visualize>
    </sensor>
  </gazebo>

  <!-- Foot links for contact sensors -->
  <joint name="left_foot_joint" type="fixed">
    <parent link="base_link"/>
    <child link="left_foot_link"/>
    <origin xyz="-0.1 -0.05 0" rpy="0 0 0"/>
  </joint>

  <link name="left_foot_link">
    <collision name="left_foot_collision">
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <box size="0.15 0.08 0.02"/>
      </geometry>
    </collision>
  </link>

  <joint name="right_foot_joint" type="fixed">
    <parent link="base_link"/>
    <child link="right_foot_link"/>
    <origin xyz="-0.1 0.05 0" rpy="0 0 0"/>
  </joint>

  <link name="right_foot_link">
    <collision name="right_foot_collision">
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <geometry>
        <box size="0.15 0.08 0.02"/>
      </geometry>
    </collision>
  </link>

  <!-- Contact sensors -->
  <gazebo reference="left_foot_link">
    <sensor name="left_foot_contact" type="contact">
      <update_rate>100</update_rate>
      <contact>
        <collision>left_foot_collision</collision>
      </contact>
      <always_on>true</always_on>
      <visualize>false</visualize>
    </sensor>
  </gazebo>

  <gazebo reference="right_foot_link">
    <sensor name="right_foot_contact" type="contact">
      <update_rate>100</update_rate>
      <contact>
        <collision>right_foot_collision</collision>
      </contact>
      <always_on>true</always_on>
      <visualize>false</visualize>
    </sensor>
  </gazebo>
</robot>